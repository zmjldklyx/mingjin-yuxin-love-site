<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>é“­æ´¥ â™¥ ç‰è–ªçš„å°çª</title>
  <style>
    body { margin:0; font-family:'Segoe UI',sans-serif; background:linear-gradient(to bottom right,#ffe4e1,#ffc0cb); overflow-x:hidden; }
    .container{max-width:800px;margin:0 auto;padding:20px;}
    .header{text-align:center;margin-bottom:10px;}
    .header h1{font-size:2.5em;color:#d6336c;margin:0;}
    .quote{text-align:center;font-style:italic;color:#555;margin-bottom:30px;}
    .card{background:#fff;border-radius:12px;padding:20px;margin-bottom:20px;box-shadow:0 4px 12px rgba(0,0,0,0.1);}
    .card h2{margin-top:0;color:#d6336c;}
    .link{display:inline-block;margin-top:10px;padding:8px 16px;background:#d6336c;color:#fff;border-radius:8px;text-decoration:none;}
    .floating-text{position:fixed;bottom:20px;right:20px;font-size:14px;color:#d6336c;animation:floatUp 6s infinite;}
    @keyframes floatUp{0%{transform:translateY(0);opacity:1}100%{transform:translateY(-100px);opacity:0}}
    #welcomeOverlay{position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(to bottom right,#ffc0cb,#ffe4e1);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;font-size:28px;color:#d6336c;font-weight:bold;transition:opacity 1s ease;}
    #welcomeOverlay button{margin-top:20px;padding:10px 20px;font-size:18px;background:#d6336c;color:#fff;border:none;border-radius:8px;cursor:pointer;}
    input[type="text"], input[type="file"]{margin-top:10px;padding:8px;width:100%;border:1px solid #ccc;border-radius:6px;box-sizing:border-box;}
    button{margin-top:10px;padding:8px 12px;background:#d6336c;color:#fff;border:none;border-radius:6px;cursor:pointer;}
    ul{list-style:none;padding-left:0;}
    li{padding:8px 0;font-size:16px;color:#444;position:relative;padding-left:24px;display:flex;align-items:center;justify-content:space-between;gap:10px;}
    li::before{content:"â¤";position:absolute;left:0;color:#d6336c;font-size:16px;}
    img{max-width:100%;border-radius:8px;margin-top:10px;display:block;}
    /* gallery */
    .gallery{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:16px;margin-top:10px;}
    .photo-card{background:#fff;border-radius:12px;padding:10px;box-shadow:0 4px 12px rgba(0,0,0,0.06);text-align:center;display:flex;flex-direction:column;align-items:center;gap:8px;}
    .photo-card .btn-row{width:100%;display:flex;gap:8px;justify-content:center;}
    .small-btn{padding:6px 10px;border-radius:6px;border:none;background:#d6336c;color:#fff;cursor:pointer;}
    .caption{font-size:13px;color:#666;margin-top:4px;}
    .completed{text-decoration:line-through;color:#888;}
    /* lightbox */
    #lightbox{position:fixed;inset:0;background:rgba(0,0,0,0.8);display:none;align-items:center;justify-content:center;z-index:20000;padding:20px;}
    #lightbox img{max-width:90%;max-height:80%;border-radius:8px;display:block;}
    #lightbox .caption{color:#fff;margin-top:12px;text-align:center;}
    #lightbox .close-btn{position:absolute;top:20px;right:20px;padding:8px 12px;background:#fff;color:#d6336c;border-radius:6px;border:none;cursor:pointer;}
    .edit-input{width:100%;padding:6px;border:1px solid #ccc;border-radius:6px;}
    .row{display:flex;gap:8px;align-items:center;}
  </style>
</head>
<body>
  <div id="welcomeOverlay">æ¬¢è¿æ¥åˆ°é“­æ´¥ â™¥ ç‰è–ªçš„å°çª
    <button onclick="enterSite()">è¿›å…¥å°çª</button>
  </div>

  <div class="container">
    <div class="header"><h1>é“­æ´¥ â™¥ ç‰è–ª</h1></div>

    <div class="quote" id="dailyQuote">â€œä½ æ˜¯æˆ‘å¿ƒä¸­æœ€æŸ”è½¯çš„å…‰ã€‚â€</div>

    <div class="card">
      <h2>æˆ‘ä»¬çš„çºªå¿µæ—¥</h2>
      <p>ä»2025å¹´3æœˆ15æ—¥å¼€å§‹ï¼Œæˆ‘ä»¬å·²ç»ä¸€èµ·èµ°è¿‡ <span id="daysTogether">...</span> å¤©ã€‚</p>
    </div>

    <div class="card">
      <h2>æƒ³å¯¹å¯¹æ–¹è¯´çš„è¯</h2>
      <p>æŠŠä½ æƒ³å¯¹ç‰è–ªè¯´çš„æ¯ä¸€å¥è¯éƒ½å†™ä¸‹æ¥ï¼Œè®©çˆ±åœ¨å­—é‡Œè¡Œé—´æµåŠ¨ã€‚</p>
      <a class="link" href="words.html">è¿›å…¥ç•™è¨€å¢™</a>
    </div>

    <div class="card">
      <h2>ç…§ç‰‡å›å¿†</h2>
      <input type="file" accept="image/*" id="photoUpload" />
      <div class="gallery" id="photoGallery"></div>
      <p style="font-size:12px;color:#888;margin-top:8px;">è¯´æ˜ï¼šé¡µé¢ä¼šæ˜¾ç¤ºä»“åº“ä¸­åä¸º photo1.jpg åˆ° photo10.jpg çš„å›¾ç‰‡ï¼ˆè‹¥å·²ä¸Šä¼ ï¼‰ï¼›ä½ ä¸Šä¼ çš„ç…§ç‰‡ä¼šä¿å­˜åœ¨æµè§ˆå™¨ localStorageï¼Œå¯ç¼–è¾‘æè¿°æˆ–åˆ é™¤ã€‚</p>
    </div>

    <div class="card">
      <h2>æ‹çˆ±æ¸…å•</h2>
      <input type="text" id="newItem" placeholder="è¾“å…¥æ–°çš„æ‹çˆ±ç›®æ ‡..." />
      <button onclick="addItem()">æ·»åŠ </button>
      <ul id="loveList"></ul>
    </div>
  </div>

  <div class="floating-text">é“­æ´¥ â™¥ ç‰è–ª</div>

  <!-- Lightbox -->
  <div id="lightbox" onclick="closeLightbox(event)">
    <button class="close-btn" onclick="closeLightbox(event)">å…³é—­</button>
    <div id="lightboxInner" style="text-align:center;">
      <img id="lightboxImg" src="" alt="preview" />
      <div class="caption" id="lightboxCaption"></div>
    </div>
  </div>

  <script>
    // è¿›å…¥é®ç½©
    function enterSite() {
      const overlay = document.getElementById("welcomeOverlay");
      overlay.style.opacity = "0";
      setTimeout(() => overlay.style.display = "none", 400);
    }

    // çºªå¿µæ—¥è®¡æ•°
    const startDate = new Date("2025-03-15");
    function updateDays(){
      const today = new Date();
      const diffTime = today - startDate;
      const diffDays = Math.floor(diffTime / (1000*60*60*24));
      document.getElementById("daysTogether").textContent = diffDays;
    }
    updateDays();

    // æ¯æ—¥æƒ…è¯
    const quotes = [
      "ä½ æ˜¯æˆ‘å¿ƒä¸­æœ€æŸ”è½¯çš„å…‰ã€‚",
      "æ¯ä¸€å¤©é†’æ¥ï¼Œæœ€æƒ³è§çš„äººæ˜¯ä½ ã€‚",
      "çˆ±ä½ ï¼Œæ˜¯æˆ‘æœ€åšå®šçš„é€‰æ‹©ã€‚",
      "ä½ ç¬‘çš„æ ·å­ï¼Œæ˜¯æˆ‘æœ€çˆ±çš„é£æ™¯ã€‚",
      "ä¸–ç•Œå¾ˆå¤§ï¼Œä½†æˆ‘åªæƒ³å’Œä½ ä¸€èµ·èµ°ã€‚"
    ];
    document.getElementById("dailyQuote").textContent = `â€œ${quotes[Math.floor(Math.random()*quotes.length)]}â€`;

    /* ---------- ç…§ç‰‡å›å¿†ï¼ˆpreset photo1..photo10 + ç”¨æˆ·ä¸Šä¼ ï¼Œå¯ç¼–è¾‘æè¿°ã€åˆ é™¤ã€ç¯ç®±é¢„è§ˆï¼‰ ---------- */
    const gallery = document.getElementById("photoGallery");
    let storedPhotos = JSON.parse(localStorage.getItem("photos")) || []; 
    // storedPhotos array of { src: dataUrl, caption: "" }

    // é¢„è®¾ä»“åº“å›¾ç‰‡ï¼ˆå¦‚éœ€å­ç›®å½•è¯·ä¿®æ”¹è·¯å¾„ï¼‰
    const presetPhotos = [];
    for (let i=1;i<=10;i++){ presetPhotos.push({src:`photo${i}.jpg`, caption:""}); }

    function openLightbox(src, caption){
      const lb = document.getElementById("lightbox");
      document.getElementById("lightboxImg").src = src;
      document.getElementById("lightboxCaption").textContent = caption || "";
      lb.style.display = "flex";
    }
    function closeLightbox(e){
      if(e && e.target && (e.target.id === "lightbox" || e.target.classList.contains("close-btn"))){
        document.getElementById("lightbox").style.display = "none";
      }
      // prevent click bubbling from inner close
      if (e) e.stopPropagation();
    }

    function renderPhotos(){
      gallery.innerHTML = "";
      // preset (ä¸å¯åˆ é™¤ï¼Œä½†å¯é¢„è§ˆ)
      presetPhotos.forEach(p => {
        const card = document.createElement("div"); card.className="photo-card";
        const img = document.createElement("img"); img.src = p.src; img.alt = p.src;
        img.style.cursor = "zoom-in";
        img.onclick = () => openLightbox(p.src, p.caption);
        card.appendChild(img);
        if(p.caption){
          const c = document.createElement("div"); c.className="caption"; c.textContent = p.caption; card.appendChild(c);
        }
        gallery.appendChild(card);
      });
      // uploaded (å¯ç¼–è¾‘æè¿°ã€åˆ é™¤ã€é¢„è§ˆ)
      storedPhotos.forEach((obj, idx) => {
        const card = document.createElement("div"); card.className="photo-card";
        const img = document.createElement("img"); img.src = obj.src; img.alt = `uploaded-${idx}`;
        img.style.cursor = "zoom-in";
        img.onclick = () => openLightbox(obj.src, obj.caption);
        card.appendChild(img);

        // caption display or edit
        const captionDiv = document.createElement("div");
        captionDiv.style.width = "100%";
        if(obj.caption){
          const c = document.createElement("div"); c.className="caption"; c.textContent = obj.caption; captionDiv.appendChild(c);
        } else {
          const c = document.createElement("div"); c.className="caption"; c.textContent = "ï¼ˆæ— æè¿°ï¼‰"; captionDiv.appendChild(c);
        }

        // buttons: edit caption, delete
        const btnRow = document.createElement("div"); btnRow.className="btn-row";
        const editBtn = document.createElement("button"); editBtn.className="small-btn"; editBtn.textContent="ç¼–è¾‘æè¿°";
        editBtn.onclick = () => {
          // replace captionDiv with input + save/cancel
          captionDiv.innerHTML = '';
          const input = document.createElement("input"); input.className="edit-input"; input.value = obj.caption || "";
          const save = document.createElement("button"); save.className="small-btn"; save.textContent="ä¿å­˜";
          const cancel = document.createElement("button"); cancel.className="small-btn"; cancel.textContent="å–æ¶ˆ";
          save.onclick = () => {
            obj.caption = input.value.trim();
            localStorage.setItem("photos", JSON.stringify(storedPhotos));
            renderPhotos();
          };
          cancel.onclick = () => renderPhotos();
          captionDiv.appendChild(input); captionDiv.appendChild(save); captionDiv.appendChild(cancel);
        };

        const delBtn = document.createElement("button"); delBtn.className="small-btn"; delBtn.textContent="åˆ é™¤";
        delBtn.onclick = () => {
          if(confirm("ç¡®è®¤åˆ é™¤è¿™å¼ ä¸Šä¼ çš„ç…§ç‰‡å—ï¼Ÿ")){
            storedPhotos.splice(idx,1);
            localStorage.setItem("photos", JSON.stringify(storedPhotos));
            renderPhotos();
          }
        };

        btnRow.appendChild(editBtn); btnRow.appendChild(delBtn);
        card.appendChild(captionDiv);
        card.appendChild(btnRow);
        gallery.appendChild(card);
      });
    }

    // ä¸Šä¼ 
    document.getElementById("photoUpload").addEventListener("change", (e)=>{
      const file = e.target.files && e.target.files[0];
      if(!file) return;
      const reader = new FileReader();
      reader.onload = () => {
        storedPhotos.push({src:reader.result, caption:""});
        localStorage.setItem("photos", JSON.stringify(storedPhotos));
        renderPhotos();
      };
      reader.readAsDataURL(file);
      e.target.value = "";
    });

    renderPhotos();

    /* ---------- æ‹çˆ±æ¸…å•ï¼ˆä¿ç•™åŸå§‹äº”é¡¹ï¼Œæ”¯æŒå®Œæˆã€å®Œæˆæ—¥æœŸã€ç¼–è¾‘ã€åˆ é™¤ï¼‰ ---------- */
    const loveListEl = document.getElementById("loveList");
    const defaultItems = [
      {text:"ä¸€èµ·å»çœ‹æµ· ğŸŒŠ", done:false, date:null},
      {text:"ä¸€èµ·åšé¥­ ğŸ³", done:false, date:null},
      {text:"ä¸€èµ·æ‹ä¸€å¼ å‚»å‚»çš„åˆç…§ ğŸ“¸", done:false, date:null},
      {text:"ä¸€èµ·å†™ä¸€å°æƒ…ä¹¦ ğŸ’Œ", done:false, date:null},
      {text:"ä¸€èµ·çœ‹ä¸€åœºæ—¥è½ ğŸŒ…", done:false, date:null}
    ];
    const loaded = JSON.parse(localStorage.getItem("loveItems"));
    let loveItems = (Array.isArray(loaded) && loaded.length>0) ? loaded : defaultItems.slice();

    function saveLove(){
      localStorage.setItem("loveItems", JSON.stringify(loveItems));
    }

    function renderList(){
      loveListEl.innerHTML = "";
      loveItems.forEach((item, idx) => {
        const li = document.createElement("li");
        const left = document.createElement("div"); left.style.display="flex"; left.style.alignItems="center"; left.style.gap="8px"; left.style.flex="1";
        // checkbox
        const cb = document.createElement("input"); cb.type="checkbox"; cb.checked = !!item.done;
        cb.onchange = () => {
          item.done = cb.checked;
          item.date = item.done ? new Date().toLocaleDateString() : null;
          saveLove(); renderList();
        };
        left.appendChild(cb);
        // text / completed style
        const span = document.createElement("span"); span.textContent = item.text; span.style.flex="1";
        if(item.done) span.className = "completed";
        left.appendChild(span);

        li.appendChild(left);

        // right buttons: edit, delete, show date
        const right = document.createElement("div"); right.style.display="flex"; right.style.gap="8px"; right.style.alignItems="center";
        if(item.date){
          const d = document.createElement("div"); d.style.fontSize="12px"; d.style.color="#888"; d.textContent = item.date; right.appendChild(d);
        }
        const editBtn = document.createElement("button"); editBtn.className="small-btn"; editBtn.textContent="ç¼–è¾‘";
        editBtn.onclick = () => {
          // replace span with input + save/cancel
          const input = document.createElement("input"); input.className="edit-input"; input.value = item.text;
          left.replaceChild(input, span);
          editBtn.style.display = "none";
          const save = document.createElement("button"); save.className="small-btn"; save.textContent="ä¿å­˜";
          const cancel = document.createElement("button"); cancel.className="small-btn"; cancel.textContent="å–æ¶ˆ";
          save.onclick = () => {
            const v = input.value.trim(); if(!v) return alert("å†…å®¹ä¸èƒ½ä¸ºç©º");
            item.text = v; saveLove(); renderList();
          };
          cancel.onclick = () => renderList();
          right.insertBefore(save, editBtn);
          right.insertBefore(cancel, editBtn);
        };

        const delBtn = document.createElement("button"); delBtn.className="small-btn"; delBtn.textContent="åˆ é™¤";
        delBtn.onclick = () => {
          if(confirm("ç¡®è®¤åˆ é™¤è¿™é¡¹å—ï¼Ÿ")){
            loveItems.splice(idx,1); saveLove(); renderList();
          }
        };

        right.appendChild(editBtn); right.appendChild(delBtn);
        li.appendChild(right);
        loveListEl.appendChild(li);
      });
    }

    function addItem(){
      const input = document.getElementById("newItem");
      const v = input.value.trim();
      if(!v) return;
      loveItems.push({text:v,done:false,date:null});
      saveLove(); input.value=""; renderList();
    }

    renderList();
  </script>
</body>
</html>
