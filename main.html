<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>铭津 ♥ 玉薪的小窝</title>

  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&family=Great+Vibes&display=swap" rel="stylesheet">

  <style>
    :root{
      --pink-1:#ffe8ec; --pink-2:#ffc9d6; --accent:#d6336c; --muted:#6b6b6b;
      --card-bg:rgba(255,255,255,0.92); --shadow:0 8px 20px rgba(214,51,108,0.08);
      --radius:14px; --max-width:980px; --gap:18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:'Noto Sans SC', system-ui, -apple-system,"Segoe UI",Roboto,Arial;
      background: linear-gradient(135deg,var(--pink-1),var(--pink-2));
      color:#333; display:flex; justify-content:center; padding:20px;
    }

    .site{ width:100%; max-width:var(--max-width); margin:0 auto; }

    header.top{ display:flex; gap:16px; align-items:center; margin-bottom:16px; padding:14px; border-radius:18px;
      background: linear-gradient(90deg, rgba(255,255,255,0.08), rgba(255,255,255,0.12));
      box-shadow: var(--shadow); backdrop-filter: blur(6px);
    }
    .brand{ display:flex; gap:12px; align-items:center; flex:1; min-width:0; }
    .avatar{ width:68px; height:68px; border-radius:50%; overflow:hidden; flex-shrink:0; border:3px solid rgba(255,255,255,0.8); box-shadow:0 6px 18px rgba(214,51,108,0.12); }
    .avatar img{width:100%;height:100%;object-fit:cover;display:block}
    .title{ display:flex; flex-direction:column; min-width:0; }
    .title h1{ margin:0; font-family:'Great Vibes', cursive; font-size:30px; color:var(--accent); line-height:1 }
    .title p{ margin:4px 0 0; font-size:13px; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .controls{ text-align:right; min-width:160px; display:flex; flex-direction:column; align-items:flex-end; gap:8px; }
    .enter-btn{ background:var(--accent); color:#fff; border:none; padding:8px 14px; border-radius:10px; cursor:pointer; font-weight:600; box-shadow:0 6px 16px rgba(214,51,108,0.12); }
    .quote-box{ text-align:center; margin-bottom:14px; font-style:italic; color:#444; background: linear-gradient(180deg, rgba(255,255,255,0.5), rgba(255,255,255,0.35)); padding:12px 14px; border-radius:12px; box-shadow:var(--shadow); }
    .grid{ display:grid; grid-template-columns:1fr 380px; gap:var(--gap); align-items:start; }
    @media (max-width:980px){ .grid{ grid-template-columns:1fr } }
    .left-col{ display:flex; flex-direction:column; gap:12px; }
    .card{ background:var(--card-bg); border-radius:var(--radius); padding:16px; box-shadow:var(--shadow); transition:transform .18s ease, box-shadow .18s ease; }
    .card:hover{ transform:translateY(-6px); box-shadow:0 18px 40px rgba(0,0,0,0.08) }
    .card h2{ margin:0 0 8px 0; color:var(--accent) }
    .muted{ color:var(--muted); font-size:13px }
    .btn{ background:var(--accent); color:#fff; border:none; padding:8px 10px; border-radius:8px; cursor:pointer; font-size:14px; }
    .btn.ghost{ background:transparent; color:var(--accent); border:1px solid rgba(214,51,108,0.12) }
    .gallery{ display:grid; grid-template-columns: repeat(auto-fill, minmax(140px,1fr)); gap:10px; margin-top:10px; }
    .photo-card{ border-radius:12px; overflow:hidden; background:#fff; display:flex; flex-direction:column; justify-content:flex-start; align-items:center; padding:8px; }
    .photo-card img{ width:100%; height:120px; object-fit:cover; border-radius:8px; cursor:zoom-in; }
    .photo-card .caption{ font-size:13px; color:#666; padding:8px 6px; text-align:center; min-height:44px; }
    .right-col{ display:flex; flex-direction:column; gap:12px; }
    .sticky{ position:sticky; top:18px; }
    #progressBar{ height:12px; background: linear-gradient(90deg,#ffe6ef,#ffd8e6); border-radius:8px; overflow:hidden; margin:10px 0; }
    #progressInner{ height:100%; background: linear-gradient(90deg,#ff8bb0,#d6336c); width:0%; transition:width .6s ease; }
    .love-list ul{ margin:10px 0 0; padding:0; display:flex; flex-direction:column; gap:10px; }
    .love-item{ display:flex; gap:8px; align-items:center; justify-content:space-between; padding:8px; border-radius:10px; background:rgba(255,255,255,0.88) }
    .item-left{ display:flex; gap:8px; align-items:center; flex:1 }
    .item-left input[type="checkbox"]{ transform:scale(1.12) }
    .item-left .text{ font-size:15px }
    .small{ font-size:12px; color:#777 }
    #photoManager{ display:none; position:fixed; inset:0; z-index:9998; background:rgba(0,0,0,0.6); align-items:center; justify-content:center; padding:20px; }
    #photoManager .panel{ width:100%; max-width:980px; background:#fff; border-radius:12px; padding:16px; box-shadow:0 20px 60px rgba(0,0,0,0.3); max-height:90vh; overflow:auto; }
    .manager-top{ display:flex; gap:10px; align-items:center; margin-bottom:8px; }
    .manager-top input[type="file"]{ flex:1 }
    #lightbox{ display:none; position:fixed; inset:0; background: rgba(0,0,0,0.85); z-index:10000; align-items:center; justify-content:center; padding:20px; }
    #lightbox .inner{ max-width:960px; width:100%; }
    #lightbox img{ width:100%; height:auto; border-radius:12px; max-height:80vh; object-fit:contain; }
    #lightbox .caption{ margin-top:8px; color:#fff; text-align:center }
    @media (max-width:600px){
      body{ padding:12px; }
      header.top{ flex-direction:column; align-items:flex-start; gap:10px; padding:12px; border-radius:12px; }
      .avatar{ width:56px; height:56px; }
      .title h1{ font-size:26px; }
      .controls{ width:100%; align-items:flex-start; }
      .quote-box{ font-size:14px; padding:10px; }
      .card{ padding:12px; border-radius:12px; }
      .grid{ gap:12px; }
      .photo-card img{ height:110px; }
      .gallery{ grid-template-columns: repeat(auto-fill, minmax(120px,1fr)); gap:8px; }
      .btn{ padding:10px 12px; font-size:15px; border-radius:10px; }
      input[type="text"], input[type="file"]{ padding:10px; font-size:15px; }
      #photoManager .panel{ width:100%; height:100vh; max-width:100%; border-radius:10px; padding:14px; max-height:none; }
      #lightbox .inner{ height:100vh; display:flex; flex-direction:column; justify-content:center; }
      #lightbox img{ max-height:70vh; }
      .photo-card .caption{ min-height:52px; font-size:14px; }
      .title p{ font-size:12px; }
      .enter-btn{ padding:10px 16px; }
      .right-col .card.sticky{ position:static; }
    }
    footer{ margin-top:12px; text-align:center; color:var(--muted); font-size:13px }
    .hidden{ display:none !important; }
  </style>
</head>
<body>
  <div class="site" id="mainSite">
    <header class="top">
      <div class="brand">
        <div class="avatar">
          <img src="photo1.jpg" alt="头像（可替换）" onerror="this.src='https://via.placeholder.com/150?text=%E2%9D%A4'">
        </div>
        <div class="title">
          <h1>铭津 ♥ 玉薪</h1>
          <p>我们的小窝 · 记录每一次笑与拥抱</p>
        </div>
      </div>
      <div class="controls">
        <div style="margin-bottom:6px;color:var(--muted);font-size:13px">当前：温柔模式</div>
        <button class="enter-btn" onclick="scrollToTop()">回到顶部</button>
      </div>
    </header>

    <div class="quote-box" id="dailyQuote">“你是我心中最柔软的光。”</div>

    <div class="grid">
      <div class="left-col">
        <div class="card">
          <h2>我们的纪念日</h2>
          <p class="muted">从 2025-03-15 开始，我们已经一起走过 <strong id="daysTogether">...</strong> 天。</p>
        </div>

        <div class="card">
          <h2>照片回忆</h2>
          <p class="muted">照片不在主页直接显示，点击下面按钮打开照片管理窗口来查看、添加或删除照片。</p>
          <div style="margin-top:10px;">
            <button class="btn" onclick="openPhotoManager()">查看照片回忆</button>
          </div>
        </div>

        <div class="card">
          <h2>留言墙（预览）</h2>
          <p class="muted">点击“进入留言墙”写下不想忘记的话。</p>
          <a class="btn" href="words.html">进入留言墙</a>
        </div>
      </div>

      <aside class="right-col">
        <div class="card sticky">
          <h2>恋爱清单</h2>
          <div id="progressBar"><div id="progressInner"></div></div>
          <div style="display:flex;gap:8px">
            <input id="newItem" type="text" placeholder="输入新的恋爱目标..." />
            <button class="btn" onclick="addItem()">添加</button>
          </div>
          <div class="love-list">
            <ul id="loveList"></ul>
          </div>
        </div>

        <div class="card sticky">
          <h2>小提示</h2>
          <p class="small muted">照片管理窗口支持上传、从 URL 添加、描述编辑、删除与灯箱预览。</p>
        </div>
      </aside>
    </div>

    <footer>© 铭津 & 玉薪 · 小窝</footer>
  </div>

  <!-- Photo Manager Modal -->
  <div id="photoManager" class="hidden" role="dialog" aria-modal="true">
    <div class="panel">
      <div class="manager-top">
        <input id="pmUpload" type="file" accept="image/*" />
        <div class="manager-actions">
          <button id="pmAddUrl" class="btn ghost" title="从 URL 添加">从 URL 添加</button>
          <button id="pmClose" class="btn ghost">关闭</button>
        </div>
      </div>

      <div class="gallery" id="pmGallery" aria-live="polite"></div>
    </div>
  </div>

  <!-- Lightbox -->
  <div id="lightbox" class="hidden" onclick="closeLightbox(event)" aria-hidden="true">
    <div class="inner" onclick="event.stopPropagation()">
      <img id="lightboxImg" src="" alt="预览" />
      <div class="caption" id="lightboxCaption"></div>
      <div style="text-align:center;margin-top:10px">
        <button class="btn" onclick="copyCaption()" style="margin-right:8px">复制描述 / 情话</button>
        <button class="btn ghost" onclick="closeLightbox(event)">关闭</button>
      </div>
    </div>
  </div>

  <script>
    /* 纪念日与每日情话 */
    const startDate = new Date("2025-03-15");
    function updateDays(){ const today = new Date(); const diff = Math.floor((today - startDate)/(1000*60*60*24)); document.getElementById('daysTogether').textContent = diff; }
    updateDays();
    const quotes = ["你的笑容，是我最爱的风景。","和你在一起的每一天，都是节日。","爱你，是我最坚定的选择。","世界很大，但我只想和你一起走。","你是我心中最柔软的光。"];
    document.getElementById('dailyQuote').textContent = `“${quotes[Math.floor(Math.random()*quotes.length)]}”`;

    /* 照片管理（仅显示用户上传的照片） */
    const pm = document.getElementById('photoManager');
    const pmGallery = document.getElementById('pmGallery');
    let storedPhotos = JSON.parse(localStorage.getItem('photos')) || [];
    const photoQuotes = ["你的笑容，让春天提前到来。","和你牵手，走过每一条街。","愿时间温柔以待我们的小日子。","你的名字，是我最温柔的念想。","每天都想把世界的好给你看。"];

    function openPhotoManager(){ pm.classList.remove('hidden'); pm.style.display='flex'; document.body.style.overflow='hidden'; renderPmGallery(); }
    function closePhotoManager(){ pm.classList.add('hidden'); pm.style.display='none'; document.body.style.overflow=''; }
    function renderPmGallery(){
      pmGallery.innerHTML=''; 
      storedPhotos.forEach((obj, idx)=>{
        const card = document.createElement('div'); card.className='photo-card';
        const img = document.createElement('img'); img.src = obj.src; img.onclick = ()=> openLightbox(obj.src, obj.caption || photoQuotes[idx % photoQuotes.length]);
        card.appendChild(img);
        const cap = document.createElement('div'); cap.className='caption'; cap.textContent = obj.caption || photoQuotes[idx % photoQuotes.length]; cap.onclick = ()=> editPmCaption(idx);
        card.appendChild(cap);
        const actions = document.createElement('div'); actions.style.marginTop='6px';
        const del = document.createElement('button'); del.className='btn ghost'; del.textContent='删除';
        del.onclick = ()=> { if(confirm('确认删除这张上传的照片吗？')){ storedPhotos.splice(idx,1); localStorage.setItem('photos', JSON.stringify(storedPhotos)); renderPmGallery(); } };
        actions.appendChild(del); card.appendChild(actions);
        pmGallery.appendChild(card);
      });
    }
    document.getElementById('pmUpload').addEventListener('change', (e)=> {
      const file = e.target.files && e.target.files[0]; if(!file) return;
      const reader = new FileReader(); reader.onload = ()=> { storedPhotos.push({src:reader.result, caption:''}); localStorage.setItem('photos', JSON.stringify(storedPhotos)); renderPmGallery(); };
      reader.readAsDataURL(file); e.target.value='';
    });
    document.getElementById('pmAddUrl').addEventListener('click', ()=>{ const url = prompt('输入图片 URL：'); if(url){ storedPhotos.push({src:url.trim(), caption:''}); localStorage.setItem('photos', JSON.stringify(storedPhotos)); renderPmGallery(); } });

    /* 灯箱与复制描述 */
    function openLightbox(src, caption){ document.getElementById('lightboxImg').src = src; document.getElementById('lightboxCaption').textContent = caption || ''; const lb = document.getElementById('lightbox'); lb.classList.remove('hidden'); lb.style.display='flex'; document.body.style.overflow='hidden'; }
    function closeLightbox(e){ const lb = document.getElementById('lightbox'); if(!e || e.target === lb || (e.target && e.target.classList.contains('ghost'))){ lb.style.display='none'; lb.classList.add('hidden'); document.body.style.overflow=''; } }
    function copyCaption(){ const text = document.getElementById('lightboxCaption').textContent || ''; if(!text) return alert('没有描述可复制'); navigator.clipboard.writeText(text).then(()=> alert('文本已复制到剪贴板')); }
    function editPmCaption(idx){ const current = storedPhotos[idx] && storedPhotos[idx].caption ? storedPhotos[idx].caption : ''; const text = prompt('编辑描述：', current || photoQuotes[idx % photoQuotes.length]); if(text !== null){ storedPhotos[idx].caption = text.trim(); localStorage.setItem('photos', JSON.stringify(storedPhotos)); renderPmGallery(); } }

    /* 恋爱清单 */
    const loveListEl = document.getElementById('loveList');
    const defaultItems = [
      {text:"一起去看海 🌊", done:false, date:null},
      {text:"一起做饭 🍳", done:false, date:null},
      {text:"一起拍一张傻傻的合照 📸", done:false, date:null},
      {text:"一起写一封情书 💌", done:false, date:null},
      {text:"一起看一场日落 🌅", done:false, date:null}
    ];
    const loaded = JSON.parse(localStorage.getItem('loveItems'));
    let loveItems = (Array.isArray(loaded) && loaded.length>0) ? loaded : defaultItems.slice();
    function saveLove(){ localStorage.setItem('loveItems', JSON.stringify(loveItems)); updateProgress(); }
    function updateProgress(){ const done = loveItems.filter(i=>i.done).length; const total = Math.max(1, loveItems.length); const pct = Math.round((done/total)*100); document.getElementById('progressInner').style.width = pct + '%'; document.getElementById('progressInner').title = `已完成 ${done}/${total} 项`; }
    function renderList(){ loveListEl.innerHTML=''; loveItems.forEach((it, idx)=>{ const li = document.createElement('li'); li.className='love-item'; const left = document.createElement('div'); left.className='item-left'; const cb = document.createElement('input'); cb.type='checkbox'; cb.checked = !!it.done; cb.onchange = ()=>{ it.done = cb.checked; it.date = it.done ? new Date().toLocaleDateString() : null; saveLove(); renderList(); }; left.appendChild(cb); const span = document.createElement('div'); span.className='text'; span.textContent = it.text; if(it.done) span.style.textDecoration = 'line-through'; left.appendChild(span); li.appendChild(left); const right = document.createElement('div'); right.style.display='flex'; right.style.gap='8px'; right.style.alignItems='center'; if(it.date){ const d = document.createElement('div'); d.className='small'; d.textContent = it.date; right.appendChild(d); } const edit = document.createElement('button'); edit.className='btn ghost'; edit.textContent='编辑'; edit.onclick = ()=>{ const v = prompt('编辑清单项：', it.text); if(v !== null){ it.text = v.trim() || it.text; saveLove(); renderList(); } }; const del = document.createElement('button'); del.className='btn ghost'; del.textContent='删除'; del.onclick = ()=>{ if(confirm('确认删除这项吗？')){ loveItems.splice(idx,1); saveLove(); renderList(); } }; right.appendChild(edit); right.appendChild(del); li.appendChild(right); loveListEl.appendChild(li); }); updateProgress(); }
    function addItem(){ const input = document.getElementById('newItem'); const v = input.value.trim(); if(!v) return; loveItems.push({text:v,done:false,date:null}); input.value=''; saveLove(); renderList(); }
    renderList();

    // 便捷：Esc 关闭模态
    document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape'){ const pmEl = document.getElementById('photoManager'); const lb = document.getElementById('lightbox'); if(pmEl && !pmEl.classList.contains('hidden')){ pmEl.classList.add('hidden'); pmEl.style.display='none'; document.body.style.overflow=''; } if(lb && !lb.classList.contains('hidden')){ lb.classList.add('hidden'); lb.style.display='none'; document.body.style.overflow=''; } } });
  </script>
</body>
</html>
